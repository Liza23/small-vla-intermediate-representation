
╔════════════════════════════════════════════════════════════════════════════╗
║                         VLA MODEL DATA FLOW                                ║
╚════════════════════════════════════════════════════════════════════════════╝

                              ┌──────────────┐
                              │   INPUTS     │
                              └──────┬───────┘
                                     │
           ┌─────────────────────────┼─────────────────────────┐
           │                         │                         │
           ▼                         ▼                         ▼
    ┌──────────┐            ┌──────────────┐          ┌─────────────┐
    │   RGB    │            │  Language    │          │ Proprio +   │
    │  Image   │            │ Instruction  │          │  EE Pose    │
    │ 224×224  │            │   (text)     │          │   (14D)     │
    └────┬─────┘            └──────┬───────┘          └──────┬──────┘
         │                         │                         │
         │ CLIP ViT-B/16          │ CLIP Text               │ MLPs
         │ (frozen ❄️)             │ (frozen ❄️)             │ (train 🔥)
         │                         │                         │
         ▼                         ▼                         ▼
    ┌────────┐              ┌────────┐               ┌────────────┐
    │ [512]  │              │ [512]  │               │ [512+512]  │
    └────┬───┘              └────┬───┘               └─────┬──────┘
         │                       │                         │
         │                       │                         │
         └───────────────────────┼─────────────────────────┘
                                 │
                                 ▼
                         ┌───────────────┐
                         │  CONCATENATE  │
                         │    [2048]     │
                         └───────┬───────┘
                                 │
                                 ▼
                         ┌───────────────┐
                         │ FUSION MLP    │
                         │ (train 🔥)    │
                         └───────┬───────┘
                                 │
                                 ▼
                         ┌───────────────┐
                         │  CONDITION    │
                         │    [512]      │
                         └───────┬───────┘
                                 │
                                 │
                ┌────────────────┴────────────────┐
                │                                 │
                │      RECTIFIED FLOW             │
                │                                 │
                │   Training:                     │
                │   ┌─────────────────┐          │
                │   │ x_t = t·x_1 +   │          │
                │   │    (1-t)·x_0    │          │
                │   └────────┬────────┘          │
                │            │                    │
                │            ▼                    │
                │   ┌─────────────────┐          │
                │   │  Flow Network   │          │
                │   │  v(x_t,t,cond)  │          │
                │   └────────┬────────┘          │
                │            │                    │
                │            ▼                    │
                │   ┌─────────────────┐          │
                │   │ Loss: MSE(v,    │          │
                │   │    x_1 - x_0)   │          │
                │   └─────────────────┘          │
                │                                 │
                │   Inference:                    │
                │   ┌─────────────────┐          │
                │   │ x_0 ~ N(0,I)    │          │
                │   └────────┬────────┘          │
                │            │ Euler (50 steps)  │
                │            ▼                    │
                │   ┌─────────────────┐          │
                │   │ x_t = x_t +     │          │
                │   │     v·dt         │          │
                │   └────────┬────────┘          │
                │            │                    │
                └────────────┼────────────────────┘
                             │
                             ▼
                     ┌───────────────┐
                     │   ACTION      │
                     │    [7D]       │
                     │ dx,dy,dz,...  │
                     └───────────────┘
